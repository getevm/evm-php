#!/usr/bin/env php
<?php

if (file_exists(__DIR__ . '/../../../autoload.php')) {
    require __DIR__ . '/../../../autoload.php';
} else {
    require __DIR__ . '/../vendor/autoload.php';
}

use Getevm\Evm\Commands\PhpCommand;
use Getevm\Evm\Services\Http\CurlDownloader;
use Symfony\Component\Console\Application;

/**
 * - evm php install 7.4.0
 * - evm php use 7.4.0
 * - evm php remove 7.4.0
 */

$downloader = new CurlDownloader();

$output = $downloader->download('https://www.learningcontainer.com/wp-content/uploads/2020/05/sample-large-zip-file.zip', function ($resource, $downloadTotal, $downloaded, $uploadTotal, $uploaded) {
    echo json_encode([
        $downloadTotal,
        $downloaded
    ]);

    if ($downloadTotal > 0) {
        echo $downloaded / $downloadSize * 100 . '%' . PHP_EOL;
    }
}, function () {

});

file_put_contents('./test.zip', $output);

$application = new Application('Environment Version Manager', '1.0.0');
$application->add(new PhpCommand);
$application->run();
